---
id: webpack3
title: Webpack 详解（一）
---

## Context

`Webpack` 在查找相对路径的时候，会以 `context` 为根目录进行查找，`context` 的默认值是 `Webpack` 启动路径，如果需要修改 `context` 的值也可以手动修改：

```js
// webpack.config.js
const path = require('path');

module.exports = {
  context: path.join(__dirname, 'src');
}
```

### Context 类型

| 类型 | 例子 | 含义 |
| --- | --- | --- |
| `string` | `path.join(__dirname, 'src')` | 设置 `Webpack` 的上下文，**必须是绝对路径** |

现在就将相对路径的根目录改成了 `src`，这个时候使用相对路径就是从 `src` 目录下进行查找。例如上面的 `entry`，就会从 `src` 目录下进行查找，也就是 `src/index.js`。

## Entry

`entry` 是 `Webpack` 配置模块的入口，`Webpack` 开始构建时会从 `entry` 的文件开始递归解析出所有依赖的模块。

举个例子：

```js
// webpack.config.js
const path = require('path');

module.exports = {
  devtool: false,
  mode: 'development',
  entry: './index.js',
  output: {
    filename: 'bundle.js',
    path: path.join(__dirname, './'),
  },
};
```

```js
// index.js
const module1 = require('module1');

module1();
```

```js
// module1.js
function module1() {
  console.log('module1');
}

module.exports = module1;
```

那么 `Webpack` 构建的时候会从 `index.js` 开始，解析依赖到了 `module1`，于是会将 `module1` 中的代码打包进 `bundle.js`。

例如：

```js
// bundle.js
function module1() {
  console.log('module1');
}

module1();
```

### Entry 类型

| 类型 | 例子 | 含义 |
| --- | --- | --- |
| `string` | `./index.js` | 入口模块的文件路径，可以是相对路径 |
| `array` | `['./index.js', './main.js']` | 入口模块的文件路径，可以是相对路径 |
| `object` | `{ index: './index.js', main: ['./main.js', './src/index.js']}` | 多入口配置，每个入口生成一个 `chunk` |

### `chunk` 名称

1. 如果 `entry` 类型为 `string` 或者 `array`，就只会生成一个 `chunk`，且名称为 `main`；
2. 如果 `entry` 类型为 `object`，则会生成多个 `chunk`，名称为 `object` 的 `key`；

### 动态配置 Entry

如果需要动态配置 `entry`，可以将 `entry` 设置为一个函数，支持同步和异步：

```js
// webpack.config.js
module.exports = {
  // 同步
  entry: function syncEntry() {
    return {
      index: './index.js',
      main: './main.js',
    };
  },
  // 异步
  entry: function asyncEntry() {
    return new Promise(function (resolve) {
      resolve({
        index: './index.js',
        main: './main.js',
      });
    });
  },
};
```

## Output
